# 软件需求规格说明书 (Software Requirements Specification)

## 1. 引言
### 1.1 目的
本文档详细描述了“世界遗产数据系统”的功能和非功能需求，指导开发团队进行系统设计和实现，并作为测试验收的依据。

### 1.2 范围
系统涵盖数据采集 (Pipeline)、数据展示 (Display) 和智能分析 (Insights) 三大模块。

## 2. 功能需求 (Functional Requirements)

### 2.1 数据采集模块 (heritage_pipeline)
#### FR-01: 增量抓取
- **描述**：系统应支持增量抓取，仅更新自上次抓取以来发生变化或新增的数据。
- **输入**：上次抓取的时间戳。
- **输出**：新抓取的数据记录。

#### FR-02: 多源支持
- **描述**：系统架构应支持扩展新的数据源（初始支持 UNESCO 官网）。
- **处理**：针对不同数据源配置不同的解析规则 (Parser)。需要爬取特定字段：英文描述、中文描述、详细内容 (Content) 等。

#### FR-03: 数据清洗
- **描述**：自动清理文本中的 HTML 标签、多余空格。

### 2.2 数据展示模块 (heritage_display)
#### FR-04: 遗产列表与筛选
- **描述**：用户可通过下拉菜单筛选遗产数据（国家、遗产类型、入选年份范围）。
- **交互**：筛选条件变化时，列表应实时或点击“查询”后刷新。

#### FR-05: 遗产详情页
- **描述**：展示遗产的完整信息，包括名称、简介（中英）、所在国家、类型。不再包含图片展示。

### 2.3 智能分析模块 (heritage_insights)
#### FR-06: 自然语言问答 (RAG)
- **描述**：用户输入自然语言问题，系统检索向量数据库中的相关片段，结合 LLM 生成回答。
- **要求**：回答必须基于库内数据，若无相关数据应明确告知。

#### FR-07: 引用来源标注
- **描述**：AI 生成的回答下方应列出参考的遗产条目名称或链接。

## 3. 非功能需求 (Non-functional Requirements)

### 3.1 性能 (Performance)
- **API 响应时间**：列表查询接口 < 500ms，详情页接口 < 300ms。
- **AI 响应时间**：AI 问答生成首字时间 < 3秒（取决于 LLM API 速度，系统内部检索耗时应 < 500ms）。
- **并发能力**：Web 服务应支持至少 50 个并发用户。

### 3.2 可靠性 (Reliability)
- **爬虫容错**：单个请求失败后应支持重试（默认 3 次），失败任务应记录日志但不中断整体流程。
- **数据一致性**：更新数据时应保证最终一致性。

### 3.3 安全性 (Security)
- **接口限流**：针对 API 接口实施限流 (Rate Limiting)，防止恶意请求。
- **数据备份**：每日自动备份数据库。

## 4. 接口需求 (Interface Requirements)
- **数据库接口**：使用 ORM (PostgreSQL) 和 Redis 客户端进行数据交互。
